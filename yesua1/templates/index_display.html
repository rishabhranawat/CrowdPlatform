  <html>
  {% extends "banner_base.html" %}

{% load i18n %}
{% load staticfiles %}

{% block head_title %}{% trans "Create Lesson Plan" %}{% endblock %}

<!-- Don't know the purpose of the following line -->
{% block body_class %}home{% endblock %}

  <body>

    {% block banner %}

     
      {% url "clp:save_lesson_plan" as save_lesson_plan_url %}

      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">

    <!-- Our own CSS -->
    <link rel="stylesheet" href="{% static "css/style.css" %}" type="text/css">

      <form action="{{save_lesson_plan_url}}" method="POST">      
      
      {% csrf_token %}
    <div class="container lesson_plan_id" id='{{lesson_plan.id}}'>
      <div id="debugArea" style="float: right">&nbsp;</div>
      
      <!-- First Div -->
      {% if engage_urls %}
      <table class="table table-hover" id="table1" name="table1">

        <thead>
          <tr>
            <th>Engage</th>
          </tr>
          <tr>
             <input type="hidden" id="subject" name="subject" value="{{lesson_plan.subject}}"/>
              <input type="hidden" id="course_name" name="course_name" value="{{lesson_plan.course_name}}"/>
             <input type="hidden" id="lesson_title" name="lesson_title" value="{{lesson_plan.lesson_title}}"/>
            <input type="hidden" id="grade" name="grade" value="{{lesson_plan.grade}}"/>
            <input type="hidden" id="bullets" name="bullets" value="{{lesson_plan.bullets}}"/>
            <input type="hidden" id="input_title" name="input_title" value="{{input_title}}"/>
          </tr>  
        </thead>

        <tbody>
          
          {% for enlink in engage_urls %}
          <!--- search result -->
           <tr>
            <input type="hidden" id="engageurl_{{enlink.item_id}}" name="engageurl_{{enlink.item_id}}" value="{{enlink.url}}"/>
            <input type="hidden" id="engagedesc_{{enlink.item_id}}" name="engagedesc_{{enlink.item_id}}" value="{{enlink.desc}}"/>
          </tr> 
          <tr id="engage_{{enlink.item_id}}_row">
            <td>
              <div class="col-md-11">
                  <h4><a href="{{ enlink.url }}" target="_blank">{{ enlink.url }}</a></h4>
                  <p>{{ enlink.desc }}</p>
              </div>
              <div class="col-md-1">
                <input id = "engage_{{ enlink.item_id}}" type="image" class="img-responsive item-delete link_item" src="{% static "images/delete.png" %}" onclick="return false;" width="20" height="20"/>
              </div> 
            </td>
          </tr> 
          <!-- search result ends -->
          {% endfor %}

        
          

        </tbody>

      </table>
      {% endif %}
      <!-- second div -->
      {% if explain_urls %}
      <table class="table table-hover" id="table2">

        <thead>
          <tr>
            <th>Explain</th>
          </tr>
        </thead>

        <tbody>
          
          <!--- search result -->
          {% for enlink in explain_urls %}
          <!--- search result -->
           <tr>
            <input type="hidden" id="explainurl_{{enlink.item_id}}" name="explainurl_{{enlink.item_id}}" value="{{enlink.url}}"/>
            <input type="hidden" id="explaindesc_{{enlink.item_id}}" name="explaindesc_{{enlink.item_id}}" value="{{enlink.desc}}"/>
          </tr>
          <tr id="explain_{{enlink.item_id}}_row">
            <td>
              <div class="col-md-11">
                  <h4><a href="{{ enlink.url }}" target="_blank" >{{ enlink.url }}</a></h4>
                  <p>{{ enlink.desc }}</p>
              </div>
              <div class="col-md-1">
                <input id = "explain_{{ enlink.item_id}}" type="image" class="img-responsive item-delete link_item" src="{% static "images/delete.png" %}" onclick="return false;" width="20" height="20"/>
              </div>
            </td>
          </tr> 
          <!-- search result ends -->
          {% endfor %}

      
          

        </tbody>
      </table>
        {% endif %}
      <!-- third div -->
      {% if evaluate_urls %}
      <table class="table table-hover" id="table3">

        <thead>
          <tr>
            <th>Evaluate</th>
          </tr>
        </thead>

        <tbody>
          <!--- search result -->
          {% for enlink in evaluate_urls %}
          <!--- search result -->
           <tr>
            <input type="hidden" id="evaluateurl_{{enlink.item_id}}" name="evaluateurl_{{enlink.item_id}}" value="{{enlink.url}}"/>
            <input type="hidden" id="evaluatedesc_{{enlink.item_id}}" name="evaluatedesc_{{enlink.item_id}}" value="{{enlink.desc}}"/>
          </tr>
          <tr id="evaluate_{{enlink.item_id}}_row">
            <td>
              <div class="col-md-11" >
                  <h4 ><a href="{{ enlink.url }}" target="_blank" display:block;width:400px;>{{ enlink.url }}</a></h4>
                  <p>{{ enlink.desc }}</p>
              </div>
              <div class="col-md-1">
                <input type="image" id = "evaluate_{{ enlink.item_id}}" class="img-responsive item-delete link_item" src="{% static "images/delete.png" %}" onclick="return false;" width="20" height="20"/>
              </div>
            </td>
          </tr> 
          <!-- search result ends -->
          {% endfor %}  
          <!-- search result ends -->


        </tbody>
      </table>
      {% endif %}

       {% if doc %}
      <table class="table table-hover" id="table4">

        <thead>
          <tr>
            <th>Documents</th>
          </tr>
        </thead>

        <tbody>
          <!--- search result -->
          {% for document in doc %}
          <!--- search result -->
          <input type="hidden" id="document_{{forloop.counter}}" name="document_{{forloop.counter}}" value="{{document.docfile}}"/>
          <tr id="document_{{forloop.counter}}_row">
            <td>
              <div class="col-md-11" >
                  <h4><a href="{{ document.docfile.url }}">{{ document.docfile.name }}</a></h4>
                  <p>Document 1</p>
              </div>
              <div class="col-md-1">
                <input type="image" id = "document_{{forloop.counter}}" class="img-responsive item-delete link_item" src="{% static "images/delete.png" %}" onclick="return false;" width="20" height="20"/>
              </div>
            </td>
          </tr> 
          <!-- search result ends -->
          {% endfor %}  
          <!-- search result ends -->


        </tbody>
      </table>
      {% endif %}

      {% if pic %}
      <table class="table table-hover" id="table4">

        <thead>
          <tr>
            <th>Pictures</th>
          </tr>
        </thead>

        <tbody>
          <!--- search result -->
          {% for document in pic %}
          <!--- search result -->
          <input type="hidden" id="Image_{{forloop.counter}}" name="Image_{{forloop.counter}}" value="{{document.docfile}}"/>
          <tr id="pic_{{forloop.counter}}_row">
            <td>
              <div class="col-md-11" >
                  <p><a href="{{ document.docfile.url }}">{{ document.docfile.name }}</a></p>
              </div>
              <div class="col-md-1">
                <input type="image" id = "pic_{{forloop.counter}}" class="img-responsive item-delete link_item" src="{% static "images/delete.png" %}" onclick="return false;" width="20" height="20"/>
              </div>
            </td>
          </tr> 
          <!-- search result ends -->
          {% endfor %}  
          <!-- search result ends -->


        </tbody>
      </table>
      {% endif %}
       <button type="submit" class="btn btn-default"> Save </button>      
      </form>

      <script type="text/javascript" src="{% static "js/jquery-1.7.1.js" %}"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
      <script>

      function deleteItem(itemType, itemId, lessonId, itemGroup) {
        $.ajax({
          type:"POST",
          url:'http://{{ request.get_host }}/create_lesson_plan/remove_from_lp/',
          data: {
            'itemType':itemType,
            'itemId':itemId,
            'lessonId':lessonId,
            'itemGroup':itemGroup
          },
          success: function(msg) {
            alert('yes ' + msg)
            if (itemType == 'url') {
              $('#' + itemGroup + '_' + itemId + '_row').remove()
            } else if (itemType == 'img') {
              $('#' + itemGroup + '_' + itemId + '_imgrow').remove()
            }
          }

        })
      }

        $('.item-delete').click(function() {
        var lessonId = $('.lesson_plan_id').attr('id')
        var itemId = ""
        var itemType = ""
        var itemGroup = ""
        console.log(lessonId)
        if ($(this).attr('id').indexOf('engage') > -1) {
          itemGroup = 'engage'
          itemId = $(this).attr('id').replace('engage_','').replace('_img','')
        } else if ($(this).attr('id').indexOf('explain') > -1) {
          itemGroup = 'explain'
          itemId = $(this).attr('id').replace('explain_','').replace('_img','')
        } else if ($(this).attr('id').indexOf('evaluate') > -1) {
          itemGroup = 'evaluate'
          itemId = $(this).attr('id').replace('evaluate_','').replace('_img','')
        }

        if ($(this).hasClass('link_item')) {
          itemType = "url"
        } else if ($(this).hasClass('img_item')) {
          itemType = "img"
        }

        alert('lesson_plan_id is ' + lessonId + '\nitem type is ' + itemType + '\nitem group is ' + itemGroup + '\nitem id is ' + itemId)
        
        var name_url = itemGroup+'url_'+itemId
        var name_desc = itemGroup+'desc_'+itemId
        console.log(name_url," ",name_desc)
      
        $('#'+name_url).val("none")
        $('#'+name_url).val("none")
        $('#'+name_desc).val("none")
        $('#'+name_desc).val("none")
        var url =  $('#'+name_desc).val()
        //console.log($('input[name= name_url]').attr("name"))
        alert('Are you sure you want to delete this item?')
        $('#' + itemGroup + '_' + itemId + '_row').remove()
        /*$(this).attr('name','none')
        $(this).attr('id','none')*/
        /*if (~deleteItem(itemType, itemId, lessonId, itemGroup)) {
           $('#' + itemGroup + '_' + itemId + '_row').remove()
        }*/
        
        return false
      })

      </script>

    </div>


    {% endblock %}
    
  </body>
</html>

